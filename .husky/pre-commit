#!/bin/sh
. "$(dirname "$0")/_/husky.sh"

echo "🔍 Running tests & checking coverage (min 80%)..."
npm run test:cov --silent
RESULT=$?

if [ $RESULT -ne 0 ]; then
  echo "❌ Push rejected: Coverage must be at least 80%."
  echo "   💡 Run 'npm run test:cov' locally to see details."
  exit 1
fi

echo "✅ Coverage OK — Push allowed 🚀"
exit 0
